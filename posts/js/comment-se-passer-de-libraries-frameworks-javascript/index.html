<!DOCTYPE html><html lang="fr" class="cssr-VerticalRhythm"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimal-ui"><title>Comment se passer de libraries/frameworks JavaScript</title><meta name="twitter:card" content="summary"/><meta name="twitter:site" content="@putaindecode"/><meta name="twitter:title" content="Comment se passer de libraries/frameworks JavaScript"/><meta name="twitter:creator" content="@bloodyowl"/><meta property="og:title" content="Comment se passer de libraries/frameworks JavaScript"/><meta property="og:type" content="article"/><meta property="og:site_name" content="Putain de code !"/><link rel="stylesheet" href="../../../stylesheets/index.css"><link rel="alternate" href="../../../feed.xml" title="Putain de code !" type="application/atom+xml"></head><body><svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
    <symbol id="putainde-Icon-bookmark" viewBox="0 0 512 512">
      <title>bookmark icon</title>
      <path d="M318.275 90v283.23L256 318.16l-62.275 55.07V90h124.55m40-40h-204.55v412L256 371.557 358.275 462V50z"/>
    </symbol>

    <symbol id="putainde-Icon-github" viewBox="0 0 512 512">
      <title>github icon</title>
      <path d="M461.633 250.645l.367-3.82c-22.896-2.22-45.667-2.418-67.79-.73 3.557-11.346 5.43-24.163 5.295-38.738-.292-30.965-10.616-55.08-26.843-75.096 3.116-18.85.77-37.7-5.11-56.56-23.188 1.898-44.054 9.493-62.635 22.686-34.725-7.044-69.447-7.493-104.172 0-21.673-14.627-42.956-21.802-63.91-22.686-6.21 20.765-7.168 41.233-1.916 61.357-18.28 19.397-25.27 42.944-24.926 69.02.196 14.926 2.496 28.208 6.738 39.95-21.796-1.598-44.2-1.385-66.732.8l.367 3.818c22.947-2.228 45.76-2.41 67.92-.678.813 1.974 1.632 3.94 2.566 5.815-24.01-.633-45.618 1.453-65.854 6.43l.913 3.723c20.538-5.048 42.54-7.08 67.107-6.254 16.246 28.865 47.52 45.825 93.063 51.206-10.58 8.594-16.27 18.73-17.735 30.2h-24.12c-32.395 0-41.227-41.303-74.78-37.228C132 320 125.5 371.598 177.588 371.598h21.88v47.297c.234 7.643-3.093 12.754-8.47 16.297 18.655 1.884 32.675-7.43 32.675-18.854V353.82l5.833-6v72.992c.245 7.265-3.284 11.392-7.03 15.34 16.433.653 31.89-2.63 32.59-16.616V349.68s5.757-3.6 5.757 0v66.58c.17 11.8 10.36 21.366 31.953 19.892-5.776-4.65-7.55-9.35-7.55-16.15v-72.18s5.95-.307 5.95 6v60.88c0 13.55 16.268 19.14 34.83 18.615-6.08-4.558-10.196-9.99-10.223-17.256v-73.216c-.63-10.762-5.003-20.906-13.582-30.358 41.63-6.392 71.638-23.01 86.58-52.796 24.646-.847 46.714 1.183 67.306 6.246l.914-3.723c-20.394-5.014-42.18-7.096-66.416-6.415.84-1.89 1.67-3.79 2.39-5.785 22.39-1.798 45.457-1.622 68.66.632zM114 310.023c-1.023 0-1.853-.588-1.853-1.313 0-.728.83-1.315 1.853-1.315 1.024 0 1.854.588 1.854 1.315 0 .726-.83 1.313-1.854 1.313zm5.833 3.98c-1.137 0-2.06-.653-2.06-1.46s.923-1.462 2.06-1.462 2.06.656 2.06 1.463-.923 1.46-2.06 1.46zm5.917 5.17c-1.333 0-2.415-.767-2.415-1.713s1.082-1.714 2.415-1.714 2.416.768 2.416 1.714-1.083 1.712-2.416 1.712zm5.75 6.206c-1.56 0-2.825-.897-2.825-2.004s1.265-2.005 2.825-2.005 2.825.9 2.825 2.006-1.265 2.003-2.825 2.003zm6.333 7.014c-1.733 0-3.14-.996-3.14-2.226s1.407-2.228 3.14-2.228 3.14.998 3.14 2.228-1.407 2.226-3.14 2.226zm7.334 7.123c-1.926 0-3.488-1.107-3.488-2.474s1.56-2.476 3.487-2.476c1.925 0 3.487 1.11 3.487 2.476s-1.562 2.474-3.487 2.474zm9.916 6.774c-2.14 0-3.875-1.23-3.875-2.748 0-1.52 1.735-2.75 3.875-2.75s3.875 1.23 3.875 2.75c0 1.518-1.735 2.75-3.875 2.75zm12.292 3.626c-2.14 0-3.875-1.23-3.875-2.75 0-1.518 1.735-2.75 3.875-2.75s3.875 1.232 3.875 2.75c0 1.52-1.735 2.75-3.875 2.75zm12.958.417c-2.14 0-3.875-1.23-3.875-2.75 0-1.518 1.735-2.75 3.875-2.75s3.875 1.232 3.875 2.75c0 1.52-1.735 2.75-3.875 2.75zm12.792.25c-2.14 0-3.875-1.23-3.875-2.75 0-1.518 1.735-2.75 3.875-2.75s3.875 1.232 3.875 2.75c0 1.52-1.735 2.75-3.875 2.75z"/>
    </symbol>

    <symbol id="putainde-Icon-home" viewBox="0 0 512 512">
      <title>home icon</title>
      <path d="M394.072 174.805l-47.916-48.023v-38.31h47.916v86.333zM462 275.815h-42.508v166.213H92.508V275.815H50L256 69.972l206 205.843zm-165.153-3.843c-15.81-3.316-29.02 4.086-38.792 19.387-9.77-15.302-22.98-22.704-38.79-19.388-36.745 10.876-36.335 69.543 38.583 113.047 75.06-43.26 75.742-102.172 39-113.048z"/>
    </symbol>

    <symbol id="putainde-Icon-pencil" viewBox="0 0 512 512">
      <title>pencil icon</title>
      <path d="M74.686 340.686L50 460.95l122.365-22.585L379.52 231.21l-97.68-97.68L74.686 340.687zm228.402-135.654l-181.89 181.89-21.214-21.213 181.89-181.89 21.214 21.212zM462 148.732l-52.662 52.66-97.682-97.68 52.662-52.662L462 148.73z"/>
    </symbol>

    <symbol id="putainde-Icon-text-file" viewBox="0 0 512 512">
      <title>text-file icon</title>
      <path d="M256 370.312h-84.495v-30H256v30zm83.495-55.416h-167.99v-30h167.99v30zm0-55.334h-167.99v-30h167.99v30zM297.818 90v85.75h85.864V422H128.317V90h169.5m25-40h-234.5v412h335.365V150.75L322.818 50z"/>
    </symbol>

    <symbol id="putainde-Icon-twitter" viewBox="0 0 512 512">
      <title>twitter icon</title>
      <path d="M462 128.223c-15.158 6.724-31.45 11.27-48.547 13.31 17.45-10.46 30.854-27.025 37.164-46.764-16.333 9.686-34.422 16.72-53.676 20.51-15.417-16.428-37.385-26.69-61.697-26.69-54.56 0-94.668 50.915-82.337 103.786-70.25-3.524-132.534-37.177-174.223-88.314-22.142 37.983-11.485 87.69 26.158 112.85-13.853-.438-26.89-4.24-38.284-10.574-.917 39.162 27.146 75.78 67.795 83.95-11.895 3.236-24.925 3.977-38.17 1.446 10.755 33.58 41.973 58.018 78.96 58.7C139.605 378.28 94.847 390.72 50 385.435c37.406 23.982 81.837 37.977 129.57 37.977 156.933 0 245.596-132.55 240.252-251.435 16.517-11.917 30.846-26.804 42.178-43.755z"/>
    </symbol>
</svg><div class="putainde-Header"><div class="Grid"><div class="Grid-cell u-size5of12"><a href="../../.." class="putainde-SiteTitle"><img alt="Putain de code !" src="../../../images/p!-logo.svg" class="putainde-Logo"><span>Putain de code !</span></a></div><div class="Grid-cell u-size7of12"><nav class="putainde-Nav"><a href="../.." data-cssr-tooltip="" class="putainde-Nav-item  "><svg style="" class="putainde-Icon putainde-Icon-bookmark"><use xlink:href="#putainde-Icon-bookmark"></use></svg> Articles</a><a href="../../../c-est-quoi-putaindecode" data-cssr-tooltip="" class="putainde-Nav-item  "><svg style="" class="putainde-Icon putainde-Icon-text-file"><use xlink:href="#putainde-Icon-text-file"></use></svg> Readme</a><a href="../../comment-contribuer" data-cssr-tooltip="" class="putainde-Nav-item  "><svg style="" class="putainde-Icon putainde-Icon-pencil"><use xlink:href="#putainde-Icon-pencil"></use></svg> Participer</a><a href="https://github.com/putaindecode/" data-cssr-tooltip="GitHub" class="putainde-Nav-item  putainde-Nav-item--icon cssr-Tooltip cssr-Tooltip--bottom"><svg style="" class="putainde-Icon putainde-Icon-github"><use xlink:href="#putainde-Icon-github"></use></svg></a><a href="https://twitter.com/putaindecode/" data-cssr-tooltip="Twitter" class="putainde-Nav-item  putainde-Nav-item--icon cssr-Tooltip cssr-Tooltip--bottom"><svg style="" class="putainde-Icon putainde-Icon-twitter"><use xlink:href="#putainde-Icon-twitter"></use></svg></a></nav></div></div></div><div class="putainde-Main"><article class="Grid putainde-Post"><div class="Grid-cell u-size8of12 Grid putainde-Post-contents"><div class="putainde-Title"><h1 class="putainde-Title-text">Comment se passer de libraries/frameworks JavaScript</h1></div><header class="putainde-Post-header"><div class="putainde-Post-metas">Écrit par <a href="http://bloodyowl.github.io">bloodyowl</a>, <span class="putainde-Date"> le 6 déc. 2013</span>. <span data-cssr-tooltip="Temps de lecture approximatif, sur une base de {{wpm}} mots par minute" data-readingTime-wpm="250" class="putainde-Post-readingTime putainde-Post-readingTime--hidden cssr-Tooltip cssr-Tooltip--top">Temps de lecture : environ  <span class="putainde-Post-readingTime-value"></span> minutes</span></div><ul class="putainde-Tags putainde-Post-tags"><li class="putainde-Tag">javascript</li><li class="putainde-Tag">frameworks</li><li class="putainde-Tag">libraries</li></ul></header><div class="putainde-Post-md"><p><strong> Petite note préalable </strong> : évidemment que ça ne marche pas sous les vieux navigateurs, cet article s’adresse principalement à toi pour te faire comprendre comment les choses marchent.</p>
<p>De plus en plus, le besoin de légèreté se fait sentir sur les pages. En dépit d’un web plus rapide sur desktop, on a maintenant beaucoup de devices connectés via 3G ou Edge (un petit coucou au métro parisien). Du coup, tu te rendras vite compte qu’embarquer jQuery + jQuery Mobile + jQuery UI et un tas d’autres plug-ins grapillés sur le web, ça commence à peser.</p>
<h2 id="pour-la-selection-d-elements"><a class="putainde-Title-anchor" href="#pour-la-selection-d-elements">#</a>Pour la sélection d’élements</h2><p>Pour remplacer ton bon vieux <code>$</code> magique, <code>document.querySelectorAll</code> semble faire l’affaire. En revanche, il retourne une instance de <code>NodeList</code>, pas d’<code>Array</code>, ce qui ne nous arrange pas des masses.</p>
<p>Du coup, on peut écrire une petite function toute con, qui nous retourne un <code>Array</code> et ses méthodes bien utiles.</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> nativeSlice = [].slice <span class="hljs-comment">// la méthode de conversion</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$</span><span class="hljs-params">(selector)</span></span>{
  <span class="hljs-keyword">var</span> list = <span class="hljs-built_in">document</span>.querySelectorAll(selector)
  <span class="hljs-keyword">return</span> nativeSlice.call(list)
}
</code></pre>
<p>Alternativement, tu peux utiliser <code>Array.apply(null, list)</code> plutôt que <code>nativeSlice.call(list)</code>, si vraiment ça te fait plaisir.</p>
<p>Une troisième solution, un peu plus chiante au quotidien (et terriblement laide), c’est d’utiliser directement les méthodes qui t’intéressent (ex. <code>[].forEach</code>) de cette façon :</p>
<pre><code class="lang-javascript">;[].forEach.call(<span class="hljs-built_in">document</span>.querySelectorAll(selector), <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(element)</span></span>{
  <span class="hljs-comment">// do something w/ element</span>
})
</code></pre>
<p>Pour en revenir à notre petite méthode <code>$</code>, on peut du coup faire :</p>
<pre><code class="lang-javascript"><span class="hljs-comment">// prends bien l'habitude de garder</span>
<span class="hljs-comment">// tes nodeLists si tu les réutilises</span>

<span class="hljs-keyword">var</span> elements = $(<span class="hljs-string">".my-elements-className"</span>)

elements.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(element)</span></span>{
  <span class="hljs-comment">// do something w/ element</span>
})
</code></pre>
<h3 id="pour-l-event-delegation"><a class="putainde-Title-anchor" href="#pour-l-event-delegation">#</a>Pour l’event delegation</h3><p>L’event delegation, c’est bien, mangez-en. Ça permet, entre autres, de ne pas attacher 150 listeners uniques à 150 éléments différents, mais à attacher un seul listener sur un parent commun, et analyser les sources des évènements à l’intérieur en se basant sur le <strong>bubbling</strong> (remontée d’évènements de la source au plus haut parent) ou <strong>capturing</strong> (descente d’évènements du plus haut parent à la source, avant même que la source ne le reçoive).</p>
<p>Pour faire de la délégation, on va procéder en trois temps :</p>
<ul>
<li>Choper <code>event.target</code></li>
<li>Vérifier que le sélecteur qui nous intéresse correspond bien à <code>event.target</code> ou un de ses parents (dans le cas où l’on clique sur le <code>.icon-Arrow</code> dans <code>.js-Button-action</code>)</li>
<li>Si ça match, on garde l’élement correspondant au sélecteur, sinon, exit</li>
</ul>
<p>Les browsers relativement récents possèdent une méthode : <code>matchesSelector</code> (et tous ses alias préfixés). Ce qu’on peut donc faire, c’est ceci :</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> docEl = document.documentElement
    <span class="hljs-comment">// si c'est dans docEl, c'est que c'est dispo</span>
<span class="hljs-keyword">var</span> nativeMatchesSelector =
      docEl.matchesSelector ||
      docEl.webkitMatchesSelector ||
      docEl.mozMatchesSelector ||
      docEl.oMatchesSelector ||
      docEl.msMatchesSelector
<span class="hljs-keyword">var</span> matchesSelector = nativeMatchesSelector || matchesPolyfill

<span class="hljs-comment">// le polyfill utilise querySelectorAll</span>
<span class="hljs-comment">// et cherche dans le parent de l'élement</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">matchesPolyfill</span><span class="hljs-params">(selector)</span></span>{
  <span class="hljs-keyword">var</span> node = this
  <span class="hljs-keyword">var</span> <span class="hljs-keyword">parent</span> = node.parentNode
  <span class="hljs-keyword">var</span> query, index, length
  <span class="hljs-keyword">if</span>(!<span class="hljs-keyword">parent</span> || <span class="hljs-keyword">parent</span>.nodeType != <span class="hljs-number">1</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>
  }
  query = <span class="hljs-keyword">parent</span>.querySelectorAll(selector)
  index = -<span class="hljs-number">1</span>
  length = query.length
  <span class="hljs-keyword">while</span>(++index &lt; length) {
    <span class="hljs-keyword">if</span>(query[index] == node) <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>
  }
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getCurrentTarget</span><span class="hljs-params">(node, selector)</span></span>{
  <span class="hljs-keyword">if</span>(matchesSelector.call(node, selector)) <span class="hljs-keyword">return</span> node
  <span class="hljs-keyword">while</span>(node = node.parentNode) {
    <span class="hljs-keyword">if</span>(node.nodeType != <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>
    <span class="hljs-keyword">if</span>(matchesSelector.call(node, selector)) <span class="hljs-keyword">return</span> node
  }
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>
}
</code></pre>
<p>Dès lors, dans nos listeners, on pourra directement procéder ainsi :</p>
<pre><code class="lang-javascript">element.addEventListener(<span class="hljs-string">"click"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(evt)</span></span>{
  <span class="hljs-keyword">var</span> currentTarget = getCurrentTarget(evt.target, <span class="hljs-string">".Button-action"</span>)
  <span class="hljs-keyword">if</span>(!currentTarget) <span class="hljs-keyword">return</span>
  <span class="hljs-comment">// all good with currentTarget</span>
})
</code></pre>
<h3 id="pour-l-ajax"><a class="putainde-Title-anchor" href="#pour-l-ajax">#</a>Pour l’Ajax</h3><p>Pourquoi est-ce que l’on appelle ça encore Ajax, d’ailleurs ? Bref.</p>
<p>Simple comme bonjour :</p>
<pre><code class="lang-javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isSuccessStatus</span><span class="hljs-params">(status)</span></span>{
  <span class="hljs-keyword">return</span> status &gt;= <span class="hljs-number">200</span> &amp;&amp; status &lt; <span class="hljs-number">300</span> || status == <span class="hljs-number">304</span>
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ajax</span><span class="hljs-params">(options)</span></span>{
  <span class="hljs-keyword">var</span> xhr = <span class="hljs-keyword">new</span> XMLHttpRequest()
  <span class="hljs-keyword">var</span> done = <span class="hljs-literal">false</span>
  <span class="hljs-keyword">var</span> async = options.hasOwnProperty(<span class="hljs-string">"async"</span>) ? options.async : <span class="hljs-literal">true</span>

  xhr.open(options.method || <span class="hljs-string">"GET"</span>, options.url, async)

  xhr.onreadystatechange = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
    <span class="hljs-keyword">if</span>(done) <span class="hljs-keyword">return</span>
    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.readyState != <span class="hljs-number">4</span>) <span class="hljs-keyword">return</span>
    done = <span class="hljs-literal">true</span>

    <span class="hljs-keyword">if</span>(isSuccessStatus(<span class="hljs-keyword">this</span>.status)) {
      <span class="hljs-keyword">if</span>(options.success) {
        options.success.call(<span class="hljs-keyword">this</span>)
      }
      <span class="hljs-keyword">return</span>
    }

    <span class="hljs-keyword">if</span>(options.error) {
      options.error.call(<span class="hljs-keyword">this</span>)
    }
  }
  <span class="hljs-built_in">Object</span>.keys(options.headers || {})
    .forEach(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(key)</span></span>{
      xhr.setRequestHeader(key, options.headers[key])
    })
  xhr.send(options.data || <span class="hljs-literal">null</span>)
  <span class="hljs-keyword">return</span> xhr
}
</code></pre>
<p>Cette fonction offre un support basique de XHR :</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> myXHR = ajax({
    url : <span class="hljs-string">"api/users"</span>,
    success : <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
      doStuff(<span class="hljs-keyword">this</span>.responseText)
    },
    error : <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
      showError(<span class="hljs-keyword">this</span>.status)
    }
})
</code></pre>
<h3 id="es5-magic"><a class="putainde-Title-anchor" href="#es5-magic">#</a>ES5 magic</h3><p>ECMAScript 5 délivre des petites méthodes très intéressantes pour se simplifier la vie, fortement inspirées par ce qu’on a l’habitude de trouver dans les bibliothèques ayant connu l’âge d’or, comme <a href="http://prototypejs.org">PrototypeJS</a> ou <a href="http://mootools.net">MooTools</a>.</p>
<p>Dès lors, plutôt qu’un ennuyeux :</p>
<pre><code class="lang-javascript">var <span class="hljs-variable">key</span>, item
<span class="hljs-keyword">for</span>(<span class="hljs-variable">key</span> in myObject) {
  <span class="hljs-keyword">if</span>(myObject.hasOwnProperty(<span class="hljs-variable">key</span>)) {
    item = myObject[<span class="hljs-variable">key</span>]
    <span class="hljs-comment">// do something</span>
  }
}
</code></pre>
<p>on peut se contenter d’un :</p>
<pre><code class="lang-javascript"><span class="hljs-built_in">Object</span>.keys(myObject)
  .forEach(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(key)</span></span>{
    <span class="hljs-keyword">var</span> item = myObject[i]
    <span class="hljs-comment">// do something</span>
  })
</code></pre>
<p>De même, on bénéficie de méthodes s’avérant très utiles, comme
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/prototype"><code>Array.prototype.map</code>, <code>Array.prototype.reduce</code>, <code>Array.prototype.filter</code></a>,
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object"><code>Object.create</code>, <code>Object.getPrototypeOf</code>, <code>Object.getOwnPropertyNames</code>, <code>Object.defineProperty</code></a>. Si cela t’intéresse, je t’invite vivement à te renseigner sur ces dernières.
Et si tu veux avoir plus de détails, read the fucking manual :
<a href="http://es5.github.io">http://es5.github.io</a>.</p>
<h3 id="des-petits-details-cools-du-cote-des-events"><a class="putainde-Title-anchor" href="#des-petits-details-cools-du-cote-des-events">#</a>Des petits détails cools du côté des events</h3><p>Avec <code>addEventListener</code>, on peut aussi passer un objet comme listener, avec <code>handleEvent</code> pour interface :</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> myElementClickEvents = {
    element : myElement,
    callbacks : [],
    handleEvent : <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(evt)</span></span>{
      <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>
      <span class="hljs-keyword">this</span>.callbacks.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(item)</span></span>{
        item.call(self.element, evt)
      })
    }
}
myElement.addEventListener(<span class="hljs-string">"click"</span>, myElementClickEvents)

myElementClickEvents.callbacks.push(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(evt)</span></span>{
  <span class="hljs-built_in">console</span>.log(evt)
})
</code></pre>
<p>Avec ça, on peut facilement garder une trace de ce qu’on passé comme listeners.</p>
<h3 id="du-type-checking-"><a class="putainde-Title-anchor" href="#du-type-checking-">#</a>Du type checking ?</h3><pre><code class="lang-javascript"><span class="hljs-keyword">var</span> getClass = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(o)</span></span>{ <span class="hljs-keyword">return</span> <span class="hljs-built_in">Object</span>.prototype.toString.call(o) }
<span class="hljs-keyword">var</span> someString = <span class="hljs-keyword">new</span> <span class="hljs-built_in">String</span>(<span class="hljs-string">"foo"</span>)

<span class="hljs-keyword">typeof</span> someString <span class="hljs-comment">// "object"</span>
getClass(someString) <span class="hljs-comment">// "[object String]", sounds more reasonable</span>
</code></pre>
<h3 id="petit-bonus"><a class="putainde-Title-anchor" href="#petit-bonus">#</a>Petit bonus</h3><p>Un petit bonus rien que pour toi : pour avoir une syntaxe plus sympathique et plus claire que les prototypes.</p>
<p>En principe, on fait comme ça :</p>
<pre><code class="lang-javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Animal</span><span class="hljs-params">(name)</span></span>{
  <span class="hljs-keyword">this</span>.name = name
}

Animal.prototype.getName = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.name
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Cat</span><span class="hljs-params">(name)</span></span>{
  Animal.call(<span class="hljs-keyword">this</span>, name)
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">K</span><span class="hljs-params">()</span></span>{}
K.prototype = Animal.prototype

Cat.prototype = <span class="hljs-keyword">new</span> K
Cat.prototype.constructor = Cat
Cat.prototype.type = <span class="hljs-string">"cat"</span>

<span class="hljs-keyword">var</span> myAnimal = <span class="hljs-keyword">new</span> Animal(<span class="hljs-string">"Foo"</span>)
<span class="hljs-keyword">var</span> myCat = <span class="hljs-keyword">new</span> Cat(<span class="hljs-string">"Bar"</span>)

myCat <span class="hljs-keyword">instanceof</span> Cat <span class="hljs-comment">// true</span>
myCat <span class="hljs-keyword">instanceof</span> Animal <span class="hljs-comment">// true</span>
</code></pre>
<p>Maintenant, à l’aide de deux petites méthodes :</p>
<pre><code class="lang-javascript"><span class="hljs-comment">// wow</span>
<span class="hljs-comment">//         many magic</span>
<span class="hljs-comment">//   very es5</span>
<span class="hljs-comment">//            wow</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">extend</span><span class="hljs-params">(object)</span></span>{
  <span class="hljs-keyword">var</span> <span class="hljs-keyword">self</span> = Object.create(this)
  <span class="hljs-keyword">if</span>(!object) <span class="hljs-keyword">return</span> <span class="hljs-keyword">self</span>
  Object.keys(object)
    .<span class="hljs-keyword">forEach</span>(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(key)</span></span>{
      <span class="hljs-keyword">self</span>[key] = object[key]
    })
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">self</span>
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">create</span><span class="hljs-params">()</span></span>{
  <span class="hljs-keyword">var</span> <span class="hljs-keyword">self</span> = Object.create(this)
  <span class="hljs-keyword">if</span>(typeof <span class="hljs-keyword">self</span>.constructor == <span class="hljs-string">"function"</span>) {
    <span class="hljs-keyword">self</span>.constructor.apply(<span class="hljs-keyword">self</span>, arguments)
  }
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">self</span>
}

<span class="hljs-keyword">var</span> klass = {
    create : create,
    extend : extend
}
</code></pre>
<p>Tu peux faire ça :</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> animal = klass.extend({
    <span class="hljs-constructor"><span class="hljs-keyword">constructor</span> : function(name)</span>{
      <span class="hljs-keyword">this</span>.name = name
    },
    getName : <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.name
    }
})

<span class="hljs-keyword">var</span> cat = animal.extend({
    <span class="hljs-constructor"><span class="hljs-keyword">constructor</span> : function(name)</span>{
      animal.constructor.call(<span class="hljs-keyword">this</span>, name)
    },
    type : <span class="hljs-string">"cat"</span>
})

<span class="hljs-keyword">var</span> myAnimal = animal.create(<span class="hljs-string">"Foo"</span>)
<span class="hljs-keyword">var</span> myCat = cat.create(<span class="hljs-string">"Bar"</span>)

cat.isPrototypeOf(myCat) <span class="hljs-comment">// true</span>
animal.isPrototypeOf(myCat) <span class="hljs-comment">// true</span>
</code></pre>
<p>Voilà, j’espère que cela a pu attiser ta curiosité d’en apprendre plus sur le langage lui-même et le DOM.</p>
</div><footer class="putainde-Post-footer"><div class="putainde-Post-footer-title">Action sur cette page</div><div class="Grid"><div class="Grid-cell u-size1of3"><a href="http://github.com/putaindecode/putaindecode.fr/edit/master/src/pages/posts/js/comment-se-passer-de-libraries-frameworks-javascript/index.md" class="putainde-Post-footer-action">Modifier</a></div><div class="Grid-cell u-size1of3"><a href="http://github.com/putaindecode/putaindecode.fr/blame/master/src/pages/posts/js/comment-se-passer-de-libraries-frameworks-javascript/index.md" class="putainde-Post-footer-action">Tracer les changements</a></div><div class="Grid-cell u-size1of3"><a href="http://github.com/putaindecode/putaindecode.fr/commits/master/src/pages/posts/js/comment-se-passer-de-libraries-frameworks-javascript/index.md" class="putainde-Post-footer-action">Historique</a></div></div></footer><div class="putainde-Author"><a href="http://bloodyowl.github.io" class="putainde-Avatar putainde-Author-picture"><img src="https://avatars.githubusercontent.com/u/1688645?v=3&amp;s=128" alt="" class="js-AnimateLoad"/></a><div class="putainde-Author-description"><div class="putainde-Author-title"><h3 class="putainde-Author-name"><span class="putainde-WrittenBy">Écrit par</span> <a href="http://bloodyowl.github.io" class="putainde-Link">bloodyowl</a></h3><div class="putainde-Author-social"><a href="http://bloodyowl.github.io" data-cssr-tooltip="Website" class="cssr-Tooltip cssr-Tooltip--top"><svg style="" class="putainde-Icon putainde-Icon-home"><use xlink:href="#putainde-Icon-home"></use></svg></a><a href="https://twitter.com/bloodyowl" data-cssr-tooltip="Twitter" class="cssr-Tooltip cssr-Tooltip--top"><svg style="" class="putainde-Icon putainde-Icon-twitter"><use xlink:href="#putainde-Icon-twitter"></use></svg></a><a href="https://github.com/bloodyowl" data-cssr-tooltip="Github" class="cssr-Tooltip cssr-Tooltip--top"><svg style="" class="putainde-Icon putainde-Icon-github"><use xlink:href="#putainde-Icon-github"></use></svg></a></div></div><p class="putainde-Author-bio">Développeur front-end, aime la bonne bière artisanale, la musique, et JavaScript; n'aime ni les points virgules, ni les gens</p></div></div><div class="putainde-Contributors"><strong class="putainde-Contributors-label">3 contributeurs</strong><div data-cssr-tooltip="bloodyowl" class="putainde-Contributor cssr-Tooltip cssr-Tooltip--bottom"><a href="http://bloodyowl.github.io" class="putainde-Avatar putainde-Contributor-avatar"><img src="https://avatars.githubusercontent.com/u/1688645?v=3&amp;s=128" alt="" class="js-AnimateLoad"/></a></div><div data-cssr-tooltip="MoOx" class="putainde-Contributor cssr-Tooltip cssr-Tooltip--bottom"><a href="http://moox.io/" class="putainde-Avatar putainde-Contributor-avatar"><img src="https://avatars.githubusercontent.com/u/157534?v=3&amp;s=128" alt="" class="js-AnimateLoad"/></a></div><div data-cssr-tooltip="Macxim" class="putainde-Contributor cssr-Tooltip cssr-Tooltip--bottom"><a href="https://github.com/Macxim" class="putainde-Avatar putainde-Contributor-avatar"><img src="https://avatars.githubusercontent.com/u/1909957?v=3&amp;s=128" alt="" class="js-AnimateLoad"/></a></div></div><div id="disqus_thread" aria-live="polite"><noscript>| Please enable JavaScript to view the
a(href="http://disqus.com/?ref_noscript") comments powered by Disqus.</noscript></div></div></article></div><div class="putainde-Footer"><div class="Grid"><div class="Grid-cell u-size3of12"><p class="putainde-Footer-text">© 1970 - 2015 Putain de code !</p></div><div class="Grid-cell u-size6of12"><ul class="putainde-Footer-list"><li><a href="../../../feed.xml">Flux RSS</a></li><li><a href="../../../projets">Projets</a></li><li><a href="https://github.com/putaindecode/forum/issues">Forum</a></li><li><a href="irc://irc.freenode.net/putaindecode">IRC</a></li><li><a href="https://github.com/putaindecode/" data-cssr-tooltip="GitHub" class="cssr-Tooltip cssr-Tooltip--top"><svg style="" class="putainde-Icon putainde-Icon-github"><use xlink:href="#putainde-Icon-github"></use></svg></a></li><li><a href="https://twitter.com/putaindecode/" data-cssr-tooltip="Twitter" class="cssr-Tooltip cssr-Tooltip--top"><svg style="" class="putainde-Icon putainde-Icon-twitter"><use xlink:href="#putainde-Icon-twitter"></use></svg></a></li></ul></div><div class="Grid-cell u-size3of12"><p class="putainde-Footer-text putainde-Footer-text--small putainde-Footer-text--right">Made with ♥︎</p></div></div></div><script>var disqus_shortname = "putaindecode";var disqus_identifier = "http://putaindecode.fr/posts/js/comment-se-passer-de-libraries-frameworks-javascript/";
var disqus_url = "http://putaindecode.fr/posts/js/comment-se-passer-de-libraries-frameworks-javascript/";
var disqus_script = "embed.js";;(function(d,s) {
s = d.createElement('script');s.async=1;s.src = '//' + disqus_shortname + '.disqus.com/'+disqus_script;
(d.getElementsByTagName('head')[0]).appendChild(s)
})(document)</script><script src="../../../scripts/index.js"></script><script>var _gaq=[['_setAccount','UA-43771806-1'],['_trackPageview']];
(function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
g.src='//www.google-analytics.com/ga.js';
s.parentNode.insertBefore(g,s)}(document,'script'));</script></body></html>